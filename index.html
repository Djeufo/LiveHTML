<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>HTML Compiler with Syntax Highlighting</title>

    <!-- CodeMirror CSS & JS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/htmlmixed/htmlmixed.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/xml/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/css/css.min.js"></script>

    <style>
      * {
        box-sizing: border-box;
      }

      body {
        display: flex;
        flex-direction: column;
        height: 100vh;
        margin: 0;
        font-family: sans-serif;
        transition: background-color 0.3s, color 0.3s;
      }

      #controls {
        padding: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 10px;
      }

      #editor-container {
        display: flex;
        flex: 1;
        overflow: hidden;
      }

      .CodeMirror {
        width: 50%;
        height: 100%;
        font-size: 16px;
      }

      iframe {
        width: 50%;
        height: 100%;
        border: none;
        background-color: white;
      }

      .divider {
        width: 2px;
        background-color: #ccc;
      }

      button {
        padding: 8px 16px;
        font-size: 14px;
        cursor: pointer;
      }

      footer {
        padding: 10px;
        text-align: center;
        font-size: 14px;
      }

      /* Light Theme */
      body.light {
        background-color: #ffffff;
        color: #000000;
      }

      body.light #controls,
      body.light footer {
        background-color: #f0f0f0;
        color: #000;
      }

      /* Dark Theme */
      body.dark {
        background-color: #1e1e1e;
        color: #ffffff;
      }

      body.dark #controls,
      body.dark footer {
        background-color: #333333;
        color: #ffffff;
      }

      body.dark .divider {
        background-color: #555;
      }

      body.dark .CodeMirror {
        background-color: #2d2d2d;
        color: #fff;
      }

      body.dark .CodeMirror-gutters {
        background-color: #2d2d2d;
        color: #aaa;
      }

      /* General button style */
      button {
        padding: 10px 18px;
        font-size: 14px;
        border: none;
        border-radius: 6px;
        transition: background-color 0.3s ease, color 0.3s ease;
        background-color: #007bff;
        color: white;
      }

      button:hover {
        background-color: #0056b3;
      }

      /* Cancel Button */
      button.cancel-btn {
        background-color: #6c757d;
      }

      button.cancel-btn:hover {
        background-color: #5a6268;
      }
      /* Export Modal Styling - Always Light Themed */
      #exportModal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.4);
        justify-content: center;
        align-items: center;
        animation: fadeIn 0.3s ease-in-out;
        z-index: 1000;
        font-family: sans-serif;
      }

      #exportModal > div {
        background-color: #ffffff !important;
        color: #000000 !important;
        padding: 20px;
        border-radius: 8px;
        width: 320px;
        max-width: 90%;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        animation: slideUp 0.3s ease-in-out;
      }

      /* Input Field in Modal */
      #fileNameInput {
        width: 100%;
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 4px;
        margin: 10px 0;
        font-size: 14px;
        background-color: #fff !important;
        color: #000 !important;
      }

      /* Modal Buttons */
      #exportModal button {
        padding: 10px 18px;
        font-size: 14px;
        border: none;
        border-radius: 6px;
        transition: background-color 0.3s ease, color 0.3s ease;
        background-color: #007bff;
        color: white;
      }

      #exportModal button:hover {
        background-color: #0056b3;
      }

      #exportModal .cancel-btn {
        background-color: #6c757d;
      }

      #exportModal .cancel-btn:hover {
        background-color: #5a6268;
      }

      /* Modal Animations */
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes slideUp {
        from {
          transform: translateY(20px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      /* Light/Dark Modal Color Support */
      body.dark #exportModal > div {
        background-color: #2d2d2d;
        color: #fff;
      }

      /* Input Field */
      #fileNameInput {
        width: 100%;
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 4px;
        margin: 10px 0;
        font-size: 14px;
      }

      body.dark #fileNameInput {
        background-color: #3c3c3c;
        border-color: #555;
        color: #fff;
      }

      /* Animation for Modal */
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes slideUp {
        from {
          transform: translateY(20px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }
    </style>
  </head>
  <body class="light">
    <div id="controls">
      <div>HTML Compiler</div>
      <div>
        <button id="exportBtn">Export as HTML</button>
        <button id="themeToggle">Switch to Dark Theme</button>
      </div>
    </div>

    <div id="editor-container">
      <textarea id="htmlInput"></textarea>
      <div class="divider"></div>
      <iframe id="preview"></iframe>
    </div>

    <!-- Export Modal -->
    <div
      id="exportModal"
      style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
      "
    >
      <div
        style="
          background: white;
          padding: 20px;
          border-radius: 5px;
          width: 300px;
          max-width: 90%;
        "
      >
        <h3>Export HTML</h3>
        <label for="fileNameInput">File name:</label>
        <input
          type="text"
          id="fileNameInput"
          value="index.html"
          style="width: 100%; margin: 10px 0; padding: 5px"
        />
        <div style="display: flex; justify-content: flex-end; gap: 10px">
          <button id="cancelExport">Cancel</button>
          <button id="confirmExport">Download</button>
        </div>
      </div>
    </div>

    <footer>&copy; 2025 Your Name or Company. All rights reserved.</footer>

    <script>
      // Initialize CodeMirror
      const editor = CodeMirror.fromTextArea(
        document.getElementById("htmlInput"),
        {
          mode: "htmlmixed",
          lineNumbers: true,
          lineWrapping: true,
          theme: "default",
        }
      );

      const preview = document.getElementById("preview");
      const themeToggle = document.getElementById("themeToggle");
      const exportBtn = document.getElementById("exportBtn");
      const body = document.body;

      // Default HTML content
      const defaultHTML =
        "<!DOCTYPE html>\n<html>\n<head>\n<title>Page Title</title>\n</head>\n<body>\n\n<h1>This is a Heading</h1>\n<p>This is a paragraph.</p>\n\n</body>\n</html>";

      editor.setValue(defaultHTML);
      preview.srcdoc = defaultHTML;

      // Live update preview
      editor.on("change", () => {
        preview.srcdoc = editor.getValue();
      });

      // Toggle Theme
      themeToggle.addEventListener("click", () => {
        const isDark = body.classList.toggle("dark");
        body.classList.toggle("light");

        themeToggle.textContent = isDark
          ? "Switch to Light Theme"
          : "Switch to Dark Theme";

        editor.setOption("theme", isDark ? "default" : "default"); // Can replace with dark theme like "monokai"
      });

      const exportModal = document.getElementById("exportModal");
      const fileNameInput = document.getElementById("fileNameInput");
      const confirmExport = document.getElementById("confirmExport");
      const cancelExport = document.getElementById("cancelExport");

      // Show modal on export click
      exportBtn.addEventListener("click", () => {
        fileNameInput.value = "index.html"; // Reset default
        exportModal.style.display = "flex";
        fileNameInput.focus();
      });

      // Download when user confirms
      confirmExport.addEventListener("click", () => {
        let fileName = fileNameInput.value.trim();
        if (!fileName) fileName = "index.html";
        if (!fileName.endsWith(".html")) fileName += ".html";

        const blob = new Blob([editor.getValue()], { type: "text/html" });
        const url = URL.createObjectURL(blob);
        const link = document.createElement("a");
        link.href = url;
        link.download = fileName;
        link.click();
        URL.revokeObjectURL(url);

        exportModal.style.display = "none";
      });

      // Hide modal on cancel
      cancelExport.addEventListener("click", () => {
        exportModal.style.display = "none";
      });
    </script>
  </body>
</html>
